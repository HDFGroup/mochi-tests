if HAVE_MARGO
bin_PROGRAMS += perf-regression/margo-p2p-latency perf-regression/margo-p2p-bw perf-regression/margo-p2p-vector perf-regression/gpu-margo-p2p-bw

#Remove -pthread doesn't work for nvcc
CUDA_CFLAGS := $(subst -pthread,,$(CFLAGS))

perf-regression/gpu-margo-p2p-bw: perf-regression/gpu-margo-p2p-bw.cu
	nvcc -I. $(CUDA_CFLAGS) $(LIBS) -I/lus/theta-fs0/software/thetagpu/openmpi-4.0.5/include -L/lus/theta-fs0/software/thetagpu/openmpi-4.0.5/lib -lmpi $< -o $@

endif

if HAVE_SSG
bin_PROGRAMS += perf-regression/ssg-test-separate-group-create \
		perf-regression/ssg-test-separate-group-attach
endif

if HAVE_BAKE
bin_PROGRAMS += perf-regression/bake-p2p-bw
endif

if HAVE_PMDK
bin_PROGRAMS += perf-regression/pmdk-bw
endif

if HAVE_MPI
perf_regression_node_microbench_SOURCES = \
 perf-regression/node-microbench.c \
 perf-regression/node-microbench-util.c
perf_regression_node_microbench_LDADD = -lpthread
bin_PROGRAMS += perf-regression/node-microbench
endif
